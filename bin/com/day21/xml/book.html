<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>

<script type="text/javascript">
	var xmlDoc = new ActiveXObject("Msxml2.DoMDocument");
	xmlDoc.load("book.xml");

	function printNodeItem() {

		// 		var root = xmlDoc.getElementsByTagName("booklist")[0];
		var root = xmlDoc.documentElement;

		var books = root.getElementsByTagName("book");
		var out = "";

		for (var i = 0; i < books.length; i++) {


			out += "분류 : "
					+ books[i].getAttribute("kind")
					+ " / 제목 : "
					+ books[i].getElementsByTagName("title")[0].firstChild.nodeValue
					+ "\n"
					+ " / 저자 : "
					+ books[i].getElementsByTagName("author")[0].firstChild.nodeValue
					+ "\n"
					+ " / 가격 : "
					+ books[i].getElementsByTagName("price")[0].firstChild.nodeValue
					+ "\n";

		}

		alert(out);

	}
	
	function insert(){
		var root = xmlDoc.documentElement;
		var book = root.getElementsByTagName("book")[0];
		book.setAttribute("year","2018");
		
		var node = xmlDoc.createElement("출판사");
		var text = xmlDoc.createTextNode("아이티윌");
		book.appendChild(node);
		node.appendChild(text);
		
		alert(xmlDoc.xml);
		
		
	}
	
	function remove(){
		var root = xmlDoc.documentElement;
		for (var i = 0; i < root.childNodes.length; i++) {
			var book = root.getElementsByTagName("book")[i];
			book.removeAttribute("kind");
		}
		
		alert(xmlDoc.xml);
	}
</script>



</head>
<body>

	<input type="button" value="노드출력" onclick="printNodeItem();" />
	<br />

	<input type="button" value="추가" onclick="insert();" />
	<br />

	<input type="button" value="삭제" onclick="remove();" />
	<br />


</body>
</html>