<!DOCTYPE html >
<html>
<head>
<meta charset="EUC-KR">
<title>XML 파싱</title>

<script type="text/javascript">
	//전역변수
	var xmlDoc = new ActiveXObject("Msxml2.DOMDocument");
	xmlDoc.load("city.xml");

	//함수(메소드)
	function printNodeName() {

		var city = xmlDoc.getElementsByTagName("도시")[0];
		var cityName = city.firstChild.nodeName;
		
		

		alert("첫번째도시 : " + cityName);
		var cityName = city.lastChild.nodeName;
		alert("마지막도시 : " + cityName);
		
		var cityNames= "";
		for(var i = 0 ; i < city.childNodes.length ; i++){
			cityNames = cityNames + "\n" + city.childNodes[i].nodeName;
		}
		
		alert("전체도시 : " + cityNames);

		
	}
	
	function printNodeValue(){
		var seoul = xmlDoc.getElementsByTagName("서울")[0];
		var items = seoul.getElementsByTagName("구");
		
		var out="";
		
		for(var i = 0 ; i < items.length ; i++){
			out += items[i].childNodes[0].nodeValue + "\n";
		}
		alert(out);
	}
	
	function printXML(){
		alert(xmlDoc.xml);
	}
	
	
</script>

</head>




<body>

	<input type="button" value="노드이름출력" onclick="printNodeName();" /><br/>
	
	<input type ="button" value ="노드값출력" onclick="printNodeValue();" /><br/>

	<input type ="button" value ="XML구조출력" onclick ="printXML();" /> <br/>

</body>
</html>